<!DOCTYPE html>

<!--

Falta:
- Plotiar mapa
- Dates dinamicos
- Sorting Data
- Breaking H y Condition Logic
- Fetchar Data directamente de csv

-->


<html lang="en" ng-app='beachHazardApp'>
    <head>
        <meta charset="UTF-8">
        <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css"> 
        <link href="http://netdna.bootstrapcdn.com/font-awesome/2.0/css/font-awesome.css" rel="stylesheet">
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>
        <div class="table-container" style="margin: 20px;">

            <!-- TODO: Fix this -->

            <p><span style="mso-fareast-font-family:&quot;Times New Roman&quot;;
            mso-bidi-font-family:Arial">This preliminary experimental product  provides estimates of breaker heights (face value, crest to through) for  many of the most popular beaches in Puerto Rico. The estimated breaker  heights are based beach-specific predictions from the CariCOOS Nearshore  Wave Model (</span><span style="mso-bidi-font-family:Arial"><a href="http://caricoos.org/drupal/swan_multigrid"><span style="mso-fareast-font-family:
            &quot;Times New Roman&quot;">http://caricoos.org/drupal/swan_multigrid</span></a></span><span style="mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Arial">)  and adjustments to these predictions based on analytical and empirical  formulae. Three levels of estimated breaker conditions are presented in  the map below: low to moderate (maximum breaker heights &lt; 4 feet),  moderate to high (maximum breaker heights between 4 and 6 feet), and  high to very large (maximum breaker heights &gt; 6 feet). The estimates  of maximum breaker heights are conservative and can overestimate the  actual breaker heights, however, larger breaking waves than those  predicted could occur.</span></p>
            <p><span style="mso-fareast-font-family:&quot;Times New Roman&quot;;
            mso-bidi-font-family:Arial">This product is still in an experimental  stage and should not be used to make decisions at this moment. In  addition, the colored flags are only suggestive of breaker height  conditions and do not constitute an official beach hazards warning level  for these beaches. For official warning and advisory information,  please visit the National Weather Service &ndash; San Juan Office (</span><span style="mso-bidi-font-family:Arial"><a href="http://www.srh.noaa.gov/sju/"><span style="mso-fareast-font-family:&quot;Times New Roman&quot;">http://www.srh.noaa.gov/sju/</span></a></span><span style="mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Arial">). For technical questions related to this product, please contact <a href="mailto:CariCOOS@gmail.com?subject=Breaker%20Height%20Estimator">Dr. Miguel Canals.</a> </span></p>
            <p>&nbsp;</p>
            <p><strong><em>Select a beach for detailed report</em></strong></p>
            <p style="text-align:center;">&nbsp;</p>
            <p style="text-align:center;"><!--<img src="http://www.caricoos.org/images/l.png" alt="" /> NONE to LOW (<span style="mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Arial">&lt; 2 feet)</span> &nbsp; --><img src="http://www.caricoos.org/images/m.png" alt="" /> LOW to MODERATE (between 2 and 4<span style="mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Arial">&nbsp;feet)</span> &nbsp; <img src="http://www.caricoos.org/images/h.png" alt="" />MODERATE to HIGH (<span style="mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Arial">between 4 and 6 feet)</span>&nbsp; <img src="http://www.caricoos.org/images/x.png" alt="" /> HIGH to VERY&nbsp;LARGE<span style="mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:Arial">(&gt; 6 feet)</span></p>


            <div id="map" style="width: 96%; height: 470px; margin:20px;">&nbsp;</div>

            <ul  style="width: 96%; margin-left:20px; margin-right:20px;"  class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#sectionA">Friday, January 23</a></li>
                <li><a data-toggle="tab" href="#sectionB">Saturday, January 24</a></li>
            </ul>

            <div style="width: 96%; margin-left:20px; margin-right:20px;" class="tab-content" ng-controller="beachHazardController as beachHazard">

                <div id="sectionA" class="tab-pane fade in active">
            
                    <aside>         
                        <section class="content">
                            <table class="table table-bordered table-hover">
                                    <thead>
                                        <tr ng-class="'headerTable'">
                                            <th>Town &nbsp; <a ng-click=""><i class="icon-sort"></i></a></th>
                                            <th>Beach Name  &nbsp; <a ng-click=""><i class="icon-sort"></i></a></th>
                                            <th>Beach Bathymetry</th>
                                            <th>Breaker Prediction</th>
                                            <th>Breaker Height & Condition &nbsp; <a ng-click=""><i class="icon-sort"></i></a></th>
                                        </tr>
                                    </thead>
                                    <tbody 
                                    ng-repeat="item in beaches | startFrom: pagination.page * pagination.perPage | limitTo: pagination.perPage | filter:searchItem">
                                        <tr>
                                            <td>{{item.pueblo | removeSpaces}}</th>
                                            <td>{{item.name}}</th>
                                            <td><a href="" ng-click="generatePupUP(item['beach link'], 'bathy')">Click Here</a></th>
                                            <td><a href="" ng-click="generatePupUP(item['beach link'], 'bulletin')">Click Here</a></th>
                                            <td><img ng-src="{{item['hazard level'] | generateIcon }}" />&nbsp;{{item["hazard level"] | changeWarning}}</th>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div style="margin: 5px;" class="btn-group pull-left">
                                    <button type="button" class="btn btn-default dropdown-toggle" 
                                    data-toggle="dropdown" aria-expanded="false">
                                        Per Page <span class="caret"></span>
                                    </button>

                                    <ul class="dropdown-menu" role="menu">
                                        <li ng-click="changeNumberOfPages(10)" ><a href="">10</a></li>
                                        <li ng-click="changeNumberOfPages(20)"><a href="">20</a></li>
                                        <li ng-click="changeNumberOfPages(30)"><a href="">30</a></li>
                                        <li ng-click="changeNumberOfPages(40)"><a href="">40</a></li>
                                        <li ng-click="changeNumberOfPages(50)"><a href="">50</a></li>
                                        <li ng-click="changeNumberOfPages(500)"><a href="">All</a></li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 5px;" class="pull-left">
                                    <ul style="margin: 0px;" class="pagination">
                                        <li>
                                            <a href="" ng-click="pagination.prevPage()">&laquo;</a>
                                        </li>
                                        <li ng-repeat="n in [] | range: pagination.numPages" ng-class="{active: n == pagination.page}">
                                            <a href="" ng-click="pagination.toPageId(n)">{{n + 1}}</a>
                                        </li>
                                        <li>
                                            <a href="" ng-click="pagination.nextPage()">&raquo;</a>
                                        </li>
                                    </ul>
                                </div>

                        </section>
                    </aside>
                </div>

                <div id="sectionB" class="tab-pane fade">
                    <h3>Friday, January 23</h3>
                    <aside>                  
                        <section class="content">
                            
                        </section>
                    </aside>
                </div>
            </div>
        </div>


        <div id="myModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 id="popUpTitle" class="modal-title">Modal title</h4>
              </div>
              <div class="modal-body">
                <img  height="100%" width="100%" id="pupUpImg" src="" />
              </div>
            </div>
          </div>
        </div>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.11/angular.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyB2dhC19xC5PHj2E22R_w9--1QrF557JEs&sensor=false"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="simplePagination.js"></script> <!-- Add this module -->
    <script type="text/javascript">

        (function() {
            var app = angular.module('beachHazardApp', ['simplePagination']);

            app.controller('beachHazardController', ['$scope', '$http', 'Pagination', function($scope, $http, Pagination){
            
                $scope.pagination = Pagination.getNew();
                $scope.beaches = [];

                $http.get('data.json').
                    success(function(data, status, headers, config) {
                        $scope.beaches = data;
                        $scope.pagination = Pagination.getNew(15);
                        $scope.pagination.numPages = Math.ceil($scope.beaches.length/$scope.pagination.perPage);
                    }).
                    error(function(data, status, headers, config) {
                        alert("Error loading the data.")
                });

                $scope.changeNumberOfPages = function(num){
                   $scope.pagination = Pagination.getNew(num);
                    $scope.pagination.numPages = Math.ceil($scope.beaches.length/$scope.pagination.perPage);
                }

                $scope.generatePupUP = function(link, type) {
                    var newLink = link;
                    document.getElementById("pupUpImg").src = newLink;
                    document.getElementById("popUpTitle").innerHTML = "Breaker Prediction";
                    if(type == 'bathy') {
                        newLink = newLink.replace("bulletin", "bathy");
                        document.getElementById("pupUpImg").src = newLink;
                        document.getElementById("popUpTitle").innerHTML = "Beach Bathymetry";
                    } 



                    $('#myModal').modal('toggle')
             
                }
                
            }]);
            
            app.filter('removeSpaces', function() {
              return function (text) {
                  var str = text.replace('_', ' ');
                  return str;
                    };
            });

            app.filter('changeWarning', function() {
              return function (text) {
                    if(text == 'medium') {
                        return "LOW to MODERATE";
                    } else if(text == 'high') {
                        return "MODERATE to HIGH";
                    } else if(text == 'extreme') {
                        return "HIGH to VERY LARGE"
                    } else {
                        return "NONE to LOW";
                    }
                };
            });

            app.filter('generateIcon', function() {
              return function (text) {
                    if(text == 'medium') {
                        return "http://www.caricoos.org/images/m.png";
                    } else if(text == 'high') {
                        return "http://www.caricoos.org/images/h.png";
                    } else if(text == 'extreme') {
                        return "http://www.caricoos.org/images/x.png";
                    } else {
                        return "http://www.caricoos.org/images/l.png";
                    }
                };
            });

        })();


        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 9,
          center: new google.maps.LatLng(18.18, -66.0),
          mapTypeId: google.maps.MapTypeId.TERRAIN
        });

    </script>
    
    </body>
</html>